<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>SLProject: onPaint</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="SLProject.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">SLProject
   &#160;<span id="projectnumber">1.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('on_paint.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">How one frame gets painted </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="onPaint"></a>
How one frame gets painted</h1>
<p>The most outer onPaint routine gets called in the main event loop whenever the slUpadateAndRepaint returns true. Repaints occure therefore as fast as possible and only when needed. If nothing happens (no animation or camera move) no repaint is requested and energy can be saved. There is no timer involved.</p>
<p><b>onPaint</b>: <b>slUpdateAndPaint</b>: C interface function <a class="el" href="class_s_l_scene.html#af10cab4b78dffad547f02c0ad59b447b" title="Updates all animations in the scene after all views got painted. ">SLScene::onUpdate</a>: Return if not all views are finished. Calculate the frame time over all views. <a class="el" href="class_s_l_input_manager.html#accbdab788493640e8258459df7c284dd">SLInputManager::pollEvents</a> polls and processes the queued up user or device events. <a class="el" href="class_s_l_anim_manager.html#afcc519a0a1ba33d6ee82aad478e807ce" title="Advances the time of all enabled animation plays. ">SLAnimManager::update</a>: All enabled node animations get updated by the elapsed time. Call <a class="el" href="class_s_l_skeleton.html#af029399f0f45636f0bcefcc1413467d5">SLSkeleton::updateAnimations</a> for all enabled skeletons with the elapsed time. <a class="el" href="class_s_l_node.html#a3bccab948a39fcc148aad5001fb1556f">SLNode::updateAABBRec</a> called on the root node to resize the axis aligned bounding boxes of all nodes that have changed during animation. <a class="el" href="class_s_l_mesh.html#aedfb06b857da0a6d1a34c55e262c7418" title="Transforms the vertex positions and normals with by joint weights. ">SLMesh::transformSkin</a> is called on all meshes with skeletons that use SW skinning. <a class="el" href="class_s_l_mesh.html#a11e6c7de2a3858d51c59d25429982412">SLMesh::updateAccelStruct</a> called on all meshes with software skinning, <a class="el" href="class_s_l_scene_view.html#abea37b678675c6f677e63fe5c483d5b2">SLSceneView::onPaint</a> called for every sceneview: <a class="el" href="class_s_l_scene_view.html#afb4df9c64c43b375e3ab979a07619418" title="Draws the 3D scene with OpenGL. ">SLSceneView::draw3DGL</a> <a class="el" href="class_s_l_camera.html#a94d44906da311f355b02e1e75663e2ef">SLCamera::camUpdate</a> updates any camera animation (smooth transitions) All buffers are cleared (color, depth and Occulus frame buffer) <b>Camera Settings</b>: <a class="el" href="class_s_l_camera.html#a9b7c32f1989260a83f9fe38c179ac7f9">SLCamera::setProjection</a> sets the projection (perspective, orthographic or one of the stereo projections) and viewport. On stereo the projection for the left eye is set. <a class="el" href="class_s_l_camera.html#a82d7d0395e815d6d5de2633d1e5530e2">SLCamera::setView</a> applies the view transform. <b>Frustum Culling</b>: <a class="el" href="class_s_l_camera.html#a9866ac380c8f97046d7eb129796aeed1" title="SLCamera::setFrustumPlanes set the 6 plane from the view frustum. ">SLCamera::setFrustumPlanes</a> set the cameras frustum planes according to the current projection and view transform. <a class="el" href="class_s_l_node.html#a487230f1024cac5f12be34226de76f4c">SLNode::cullRec</a> called on the root node: All nodes are checked if they are visible. All visible nodes without transparencies (opaque) are added to the _opaqueNodes vector. All visible nodes with transparencies are added to the _blendNodes vector. <a class="el" href="class_s_l_scene_view.html#a265b94097ecec9fe8bf4d685e095c4a0">SLSceneView::draw3DGLAll</a>: Blending is turned off and the depthtest on <a class="el" href="class_s_l_scene_view.html#a5c9df994f7be5008bfd2fd6797efe2ea">SLSceneView::draw3DGLNodes</a> is called for every node in the _opaqueNodes vector: The view matrix is applied to the modelview matrix The nodes world matrix is applied to the modelview matrix <a class="el" href="class_s_l_mesh.html#af4d3add1aa69f6d1e46fe801a93466f4">SLMesh::draw</a> is called on all meshes of the node: 1) Apply the drawing bits 2) Apply the uniform variables to the shader 2a) Activate a shader program if it is not yet in use and apply all its material paramters. 2b) Pass the modelview and modelview-projection matrix to the shader. 2c) If needed build and pass the inverse modelview and the normal matrix. 2d) If the mesh has a skeleton and HW skinning is applied pass the joint matrices. 3) Build VBOs once 4) Bind and enable attribute pointers <span style="color:red"><b>5) Finally do the draw call</b></span> 6) Disable attribute pointers 7) Draw optional normals &amp; tangents 8) Draw optional acceleration structure <a class="el" href="class_s_l_scene_view.html#a61747f13ab0419c427c372bbfe1b4694">SLSceneView::draw3DGLLines</a>: for every node in the _opaqueNodes vector: The view matrix is applied to the modelview matrix If the drawbit for viewing the AABBs is set <a class="el" href="class_s_l_a_a_b_box.html#a0e21e4703665f27c68147a309dc7f2d1" title="Draws the AABB in world space with lines in a color. ">SLAABBox::drawWS</a> draws it. If the drawbit for viewing the axis is set <a class="el" href="class_s_l_a_a_b_box.html#aa743aef0f0f39e57358be4499653a065" title="Draws the axis in world space with lines in a color. ">SLAABBox::drawAxisWS</a> draws it. <a class="el" href="class_s_l_scene_view.html#a61747f13ab0419c427c372bbfe1b4694">SLSceneView::draw3DGLLines</a>: for every node in the _blendNodes vector the same as above. Blending is turned on and the depthtest off. The nodes of the _blendNotes get sorted by depth for correct transparency blending. <a class="el" href="class_s_l_scene_view.html#a5c9df994f7be5008bfd2fd6797efe2ea">SLSceneView::draw3DGLNodes</a> is called for every node in the _blendNodes vector (same as above). Blending is turned off and the depthtest on again. SLSceneView::draw3DGLALL: ... (the same but for the right eye of stereo projections) <a class="el" href="class_s_l_scene_view.html#a5b9751907097fbbda414269382a98201">SLSceneView::draw2DGL</a> is called for all 2D drawing in orthographic projection. <a class="el" href="class_s_l_scene_view.html#a1887378fb96eab8873985501a9706d64">SLSceneView::draw2DGLAll</a>: if visible the 2D Menu buttons get drawn in orthographic projection. if visible the debugging info text get drawn too. if Oculus stereo projection is used the Oculus frame buffer is drawn and swapped. return true if either an update or a camera move occured. Swap the back buffer to the front. Update the window title. return the answer from SLScene::updateIfAllViewsGotPainted and <a class="el" href="class_s_l_scene_view.html#abea37b678675c6f677e63fe5c483d5b2">SLSceneView::onPaint</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Feb 6 2015 14:26:50 for SLProject by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
